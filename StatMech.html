
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Basic statistical mechanics &#8212; Molecular Simulations - 0351-4057</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Molecular dynamics" href="MolecularDynamics.html" />
    <link rel="prev" title="Classical mechanics" href="ClassicalMech.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/tau_logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Molecular Simulations - 0351-4057</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ClassicalMech.html">
   Classical mechanics
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Basic statistical mechanics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MolecularDynamics.html">
   Molecular dynamics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="NumProjI.html">
   Numerical project I - MD simulation (NVE)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="MonteCarlo.html">
   Monte Carlo
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="NumProjII.html">
   Numerical Project II - MC simulation (NVT)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="NumProjIII.html">
   Final project
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/StatMech.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/BarakHirshberg/MolecularSimulations/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/BarakHirshberg/MolecularSimulations//issues/new?title=Issue%20on%20page%20%2FStatMech.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/BarakHirshberg/book/master/v2/gh/BarakHirshberg/MolecularSimulations/master?urlpath=tree/StatMech.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/BarakHirshberg/MolecularSimulations/blob/master/StatMech.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ensembles">
   Ensembles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#liouville-equation">
   Liouville equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phase-space-incompressibility">
   Phase space incompressibility
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#equilibrium">
   Equilibrium
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Basic statistical mechanics</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ensembles">
   Ensembles
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#liouville-equation">
   Liouville equation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#phase-space-incompressibility">
   Phase space incompressibility
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#equilibrium">
   Equilibrium
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="basic-statistical-mechanics">
<h1>Basic statistical mechanics<a class="headerlink" href="#basic-statistical-mechanics" title="Permalink to this headline">¶</a></h1>
<p>After deriving the equations of motion for a system of <span class="math notranslate nohighlight">\(N\)</span> classical particles, we would next like to solve for their trajectories and use them to evaluate thermodynamic properties of a macroscopic system, such as the temperature, energy, pressure etc. If we can connect an observable macroscopic property <span class="math notranslate nohighlight">\(A\)</span> to some function of the microstate of the system, <span class="math notranslate nohighlight">\(a(\textbf{x})\)</span>, we might associate the measured value of <span class="math notranslate nohighlight">\(A\)</span> with a <strong>time average</strong>, denoted by <span class="math notranslate nohighlight">\(\bar{a}_{\tau}\)</span> and defined as</p>
<div class="math notranslate nohighlight" id="equation-time-av">
<span class="eqno">(22)<a class="headerlink" href="#equation-time-av" title="Permalink to this equation">¶</a></span>\[
A = \bar{a}_{\tau} =  \frac{1}{\tau} \int_0^{\tau} a(\textbf{x}(t)) \mathrm{d} t,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is some long time scale compared to the molecular or atomic motion.</p>
<p>But now we find ourselves at an impasse. It is entirely clear what rules determine the evolution of the system in time, but solving the equations analytically is impossible. A numerical solution is similarly unfeasible for <span class="math notranslate nohighlight">\(\sim 10^{23}\)</span> particles, as we discussed in <a class="reference internal" href="ClassicalMech.html#discussion"><span class="std std-ref">the previous chapter</span></a>.  The core idea of statistical mechanics is to provide an alternative approach to obtain macroscopic thermodynamic observables.</p>
<div class="section" id="ensembles">
<h2>Ensembles<a class="headerlink" href="#ensembles" title="Permalink to this headline">¶</a></h2>
<p>It was <a class="reference external" href="https://en.wikipedia.org/wiki/Josiah_Willard_Gibbs">J.W. Gibbs</a> that realized that thermodynamic macroscopic properties are not very sensitive to the details of the specific microscopic state of the system. Consider for example the temperature. You have learned in a preceding statistical thermodynamics course that each momentum degree of freedom contributes <span class="math notranslate nohighlight">\(\frac{1}{2} k_B T \)</span> to the average thermal kinetic energy (the <a class="reference external" href="https://en.wikipedia.org/wiki/Equipartition_theorem">equipartition theorem</a>). Thus, the temperature can be obtained from the average kinetic energy of the system. But there are many ways to choose the momenta of the particles such that the average kinetic energy is the same. In other words, the temperature is insensitive to the specific microstate of the system, as long as it gives the same average kinetic energy.</p>
<p>Following this reasoning, and to make progress in connecting miscroscopic properties with thermodynamic observables, Gibbs introduced the concept of an <strong>ensemble</strong>. An ensemble is a collection of <span class="math notranslate nohighlight">\(\mathcal{N}\)</span> systems that obey the same microscopic interactions and are characterized by a common set of three thermodynamic properties, such as the number of particles <span class="math notranslate nohighlight">\(N\)</span>, the volume <span class="math notranslate nohighlight">\(V\)</span>, the total energy <span class="math notranslate nohighlight">\(E\)</span>, the temperature <span class="math notranslate nohighlight">\(T\)</span>, the pressure <span class="math notranslate nohighlight">\(P\)</span> or the chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>. Each system in the ensemble evolves in time from different initial conditions and is characterized by a unique microscopic state defined by its path in phase space, <span class="math notranslate nohighlight">\(\textbf{x}(t)\)</span>, defined in Eq. <a class="reference internal" href="ClassicalMech.html#equation-x-phase-space">(7)</a>. The entire ensemble can then be represented as a “cloud” of points in phase space.</p>
<p>We define the function <span class="math notranslate nohighlight">\(f(\textbf{x},t)\)</span>, called the <strong>phase space distribution function</strong>, as the probability density of observing a system in the ensemble in a specific microstate at time <span class="math notranslate nohighlight">\(t\)</span>. Since it is a probability density, it has to fulfil the properties:</p>
<div class="amsmath math notranslate nohighlight" id="equation-35ba7bd6-8676-46ca-9165-0ec0024f2ae1">
<span class="eqno">(23)<a class="headerlink" href="#equation-35ba7bd6-8676-46ca-9165-0ec0024f2ae1" title="Permalink to this equation">¶</a></span>\[\begin{align}
 \int f(\textbf{x},t) \, \mathrm{d} \textbf{x} &amp;= 1, &amp; f(\textbf{x},t) &amp; \ge 0.
\end{align}\]</div>
<p>In other words, <span class="math notranslate nohighlight">\(f(\textbf{x},t) \, \mathrm{d} \textbf{x}\)</span> represents the probability that a system from the ensemble is in the volume element between <span class="math notranslate nohighlight">\(\textbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{d} \textbf{x}\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> (or, alternatively, the fraction of systems therein).</p>
<p>Gibbs then postulated that, instead of using the time average of Eq. <a class="reference internal" href="#equation-time-av">(22)</a>, macroscopic properties can be obtained by freezing the ensemble at some time instance, and taking the average of the desired observable over all the systems, called an <strong>ensemble average</strong>. More formally, the ensemble average, denoted as <span class="math notranslate nohighlight">\(\langle a \rangle_f\)</span>, is defined as</p>
<div class="math notranslate nohighlight" id="equation-ensemble-av">
<span class="eqno">(24)<a class="headerlink" href="#equation-ensemble-av" title="Permalink to this equation">¶</a></span>\[
A(t) = \langle a \rangle_f = \int f(\textbf{x},t) a(\textbf{x}) \, \mathrm{d} \textbf{x}.
\]</div>
<p>Note the difference between Eqs. <a class="reference internal" href="#equation-time-av">(22)</a> and <a class="reference internal" href="#equation-ensemble-av">(24)</a>, the former is an integral over time while the latter is an integral over phase space. This distinction is important enough that we have used a bar to denote the time average but brackets to denote the ensemble average. Before moving forward, and discussing what we can do with ensemble averages, we will briefly investigate an important property of the phase space distribution function, described by the <strong>Liouville equation</strong>.</p>
</div>
<div class="section" id="liouville-equation">
<h2>Liouville equation<a class="headerlink" href="#liouville-equation" title="Permalink to this headline">¶</a></h2>
<p>For clarity, we will prove the Liouville equation for a single particle, but it can be generalized to <span class="math notranslate nohighlight">\(N\)</span> particles. In this case, <span class="math notranslate nohighlight">\( f(\textbf{x},t) = f(q,p,t) \)</span>.  The theorem states that the phase space distribution function is conserved along the trajectory, i.e., that</p>
<div class="math notranslate nohighlight" id="equation-liouville1">
<span class="eqno">(25)<a class="headerlink" href="#equation-liouville1" title="Permalink to this equation">¶</a></span>\[
\frac{\mathrm{d} f}{\mathrm{d} t} = \frac{\partial f}{\partial t} + \frac{\partial f }{\partial q} \dot{q} + \frac{\partial f }{\partial p} \dot{p} = 0. 
\]</div>
<p>We now consider some volume in phase space <span class="math notranslate nohighlight">\(\Omega\)</span> and define the number of systems in the ensemble whose microstate is in this volume as</p>
<div class="math notranslate nohighlight">
\[
\mathcal{N}_{\Omega} = \mathcal{N} \int_{\Omega} f(\textbf{x},t) \, \mathrm{d} \textbf{x} =  \mathcal{N} \int_{\Omega} f(q,p,t) \, \mathrm{d} q \, \mathrm{d} p.
\]</div>
<p>The rate of change of the number of systems in <span class="math notranslate nohighlight">\(\Omega\)</span> is given by</p>
<div class="math notranslate nohighlight" id="equation-rate1">
<span class="eqno">(26)<a class="headerlink" href="#equation-rate1" title="Permalink to this equation">¶</a></span>\[
\frac{\mathrm{d} \mathcal{N}_{\Omega}}{\mathrm{d} t} = \mathcal{N} \int_{\Omega} \frac{\partial f}{\partial t} \, \mathrm{d} q \, \mathrm{d} p.
\]</div>
<p>But, equivalently, the flux of molecules leaving the volume through a surface element <span class="math notranslate nohighlight">\(\mathrm{d} \mathcal{A}\)</span> can be integrated to give the rate,</p>
<div class="math notranslate nohighlight">
\[
\frac{\mathrm{d} \mathcal{N}_{\Omega}}{\mathrm{d} t} = - \mathcal{N} \int_{\mathcal{A}} f \dot{\textbf{x}} \cdot \textbf{n} \, \mathrm{d} \mathcal{A},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{n}\)</span> is a vector normal to the surface element, and <span class="math notranslate nohighlight">\(\dot{\textbf{x}}=[\dot{q},\dot{p}]\)</span>.</p>
<p>We can now use the <a class="reference external" href="https://en.wikipedia.org/wiki/Divergence_theorem">divergence theorem</a> to get</p>
<div class="math notranslate nohighlight" id="equation-rate2">
<span class="eqno">(27)<a class="headerlink" href="#equation-rate2" title="Permalink to this equation">¶</a></span>\[
\frac{\mathrm{d} \mathcal{N}_{\Omega}}{\mathrm{d} t} = - \mathcal{N} \int_{\Omega} \nabla \cdot ( f \dot{\textbf{x}} ) \, \mathrm{d} \Omega =  - \mathcal{N} \int_{\Omega}  \left[ \frac{\partial (f \dot{q})}{\partial q} + \frac{\partial (f \dot{p})}{\partial p} \right] \, \mathrm{d} q \, \mathrm{d} p.
\]</div>
<p>Eq.<a class="reference internal" href="#equation-rate2">(27)</a> and Eq. <a class="reference internal" href="#equation-rate1">(26)</a> should be equal for every volume element <span class="math notranslate nohighlight">\(\mathrm{d} q \, \mathrm{d} p \)</span>, giving</p>
<div class="math notranslate nohighlight" id="equation-pre-liouville">
<span class="eqno">(28)<a class="headerlink" href="#equation-pre-liouville" title="Permalink to this equation">¶</a></span>\[
\frac{\partial f}{\partial t} + \left[ \frac{\partial (f \dot{q})}{\partial q} + \frac{\partial (f \dot{p})}{\partial p} \right] = 0.
\]</div>
<div class="tip admonition">
<p class="admonition-title">Active learning</p>
<p>Show that the term in square brackets can be written as</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial (f \dot{q})}{\partial q} + \frac{\partial (f \dot{p})}{\partial p} =  \frac{\partial f }{\partial q} \dot{q} + \frac{\partial f }{\partial p} \dot{p}.
\]</div>
<p>Hint: Use Hamilton’s equations.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>The term in square brackets can be rearranged</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial (f \dot{q})}{\partial q} + \frac{\partial (f \dot{p})}{\partial p} =  f \left( \frac{\partial \dot{q}}{\partial q} + \frac{\partial \dot{p}}{\partial p} \right) + \frac{\partial f }{\partial q} \dot{q} + \frac{\partial f }{\partial p} \dot{p}.
\]</div>
<p>But using Hamilton’s equations, Eq. <a class="reference internal" href="ClassicalMech.html#equation-hamilton-eq">(13)</a>, the first term is zero since</p>
<div class="math notranslate nohighlight" id="equation-pre-incomp">
<span class="eqno">(29)<a class="headerlink" href="#equation-pre-incomp" title="Permalink to this equation">¶</a></span>\[
\frac{\partial \dot{q}}{\partial q} + \frac{\partial \dot{p}}{\partial p} = \frac{ \partial ^2 \mathcal{H}}{\partial q \partial p} - \frac{ \partial ^2 \mathcal{H}}{\partial p \partial q} = 0.
\]</div>
</div>
<p>Based on the solution of the above exercise, Eq. <a class="reference internal" href="#equation-pre-liouville">(28)</a> can be written as</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial f}{\partial t} + \frac{\partial f }{\partial q} \dot{q} + \frac{\partial f }{\partial p} \dot{p} = 0,
\]</div>
<p>which completes the proof of the Liouville equation.</p>
<p>Using the definition of the Poisson bracket between <span class="math notranslate nohighlight">\(f\)</span> and the Hamiltonian, Eq. <a class="reference internal" href="ClassicalMech.html#equation-poisson">(16)</a>, we can write</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial f }{\partial q} \dot{q} + \frac{\partial f }{\partial p} \dot{p} = \frac{\partial f }{\partial q} \frac{\partial \mathcal{H}}{\partial p} - \frac{\partial f }{\partial p} \frac{\partial \mathcal{H}}{\partial q} = \{ f, \mathcal{H} \},
\]</div>
<p>which leads to another useful form of the Liouville equation,</p>
<div class="math notranslate nohighlight" id="equation-liouville2">
<span class="eqno">(30)<a class="headerlink" href="#equation-liouville2" title="Permalink to this equation">¶</a></span>\[
\frac{\partial f}{\partial t} + \{ f, \mathcal{H} \}  = 0.
\]</div>
</div>
<div class="section" id="phase-space-incompressibility">
<h2>Phase space incompressibility<a class="headerlink" href="#phase-space-incompressibility" title="Permalink to this headline">¶</a></h2>
<p>An important consequence of the Liouville equation is that of <strong>phase space incompressibility</strong>. We denote an initial point in phase space as <span class="math notranslate nohighlight">\(\textbf{x}_0 = [q_0,p_0]\)</span>. The point in phase space that results from the dynamics starting from <span class="math notranslate nohighlight">\(\textbf{x}(0)\)</span> after time <span class="math notranslate nohighlight">\(t\)</span> is <span class="math notranslate nohighlight">\(\textbf{x}_t = [q_t,p_t]\)</span>. In the previous chapter, we learned that the trajectory is uniquely defined by the initial conditions, meaning that <span class="math notranslate nohighlight">\(\textbf{x}_t\)</span> can be written as a function of the initial conditions,</p>
<div class="math notranslate nohighlight">
\[
\textbf{x}_t = g(\textbf{x}_0).
\]</div>
<p>Thus, we can consider the evolution of the trajectory as a cooordinate transformation. Assuming we know the function <span class="math notranslate nohighlight">\(g\)</span>, we need to evaluate how the volume elements changes when we transform from <span class="math notranslate nohighlight">\(\mathrm{d} \textbf{x}_0\)</span> to <span class="math notranslate nohighlight">\(\mathrm{d} \textbf{x}_t\)</span>. <a class="reference external" href="https://en.wikipedia.org/wiki/Joseph_Liouville">J. Liouville</a> proved that</p>
<div class="math notranslate nohighlight" id="equation-incompressibility">
<span class="eqno">(31)<a class="headerlink" href="#equation-incompressibility" title="Permalink to this equation">¶</a></span>\[
\mathrm{d} \textbf{x}_0 = \mathrm{d} \textbf{x}_t,
\]</div>
<p>i.e., that the phase space volume element is conserved along the trajectory. Its shape might change, but not the volume.</p>
<p>Why is it important? Because, as we said, the fraction of systems in a volume element between <span class="math notranslate nohighlight">\(\textbf{x}\)</span> and <span class="math notranslate nohighlight">\(\mathrm{d} \textbf{x}\)</span> at time <span class="math notranslate nohighlight">\(t\)</span> is <span class="math notranslate nohighlight">\(f(\textbf{x},t) \, \mathrm{d} \textbf{x}\)</span>. Since the phase space distribution is conserved along the trajectory, if the volume element is conserved too, so does the fraction of systems in it. This justifies the claim that ensemble averages can be performed at any time instance.</p>
<p>To prove Eq. <a class="reference internal" href="#equation-incompressibility">(31)</a>, we remember that two volume elements of a coordinate transformation are connected through</p>
<div class="math notranslate nohighlight" id="equation-coord-transform">
<span class="eqno">(32)<a class="headerlink" href="#equation-coord-transform" title="Permalink to this equation">¶</a></span>\[
\mathrm{d} \textbf{x}_t = \mathcal{J}(\textbf{x}_t; \textbf{x}_0) \mathrm{d} \textbf{x}_0,
\]</div>
<p>where the <strong>Jacobian</strong> <span class="math notranslate nohighlight">\(\mathcal{J}\)</span> is defined as</p>
<div class="amsmath math notranslate nohighlight" id="equation-87a52a01-e01b-4726-9494-21557e4cf63d">
<span class="eqno">(33)<a class="headerlink" href="#equation-87a52a01-e01b-4726-9494-21557e4cf63d" title="Permalink to this equation">¶</a></span>\[\begin{align}
\mathcal{J}(\textbf{x}_t; \textbf{x}_0) &amp;= \det{J}, &amp; J_{kl} &amp;= \frac{\partial x_t^k}{\partial x_0^l}.
\end{align}\]</div>
<p>Then, we use a property of the determinant</p>
<div class="math notranslate nohighlight">
\[
\det{J} = e^{\mathrm{Tr} \left[ \ln{J} \right]},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathrm{Tr}[J] = \sum_k J_{kk} \)</span>. Taking the derivative, we get</p>
<div class="math notranslate nohighlight">
\[
\frac{\mathrm{d}}{\mathrm{d}t} \mathcal{J}(\textbf{x}_t;\textbf{x}_0) = \frac{\mathrm{d}}{\mathrm{d}t} e^{\mathrm{Tr} \left[ \ln{J} \right] } = e^{\mathrm{Tr} \left[ \ln{J} \right]} \mathrm{Tr} [\frac{\mathrm{d J}}{\mathrm{d}t} J^{-1}] = \mathcal{J}(\textbf{x}_t;\textbf{x}_0) \sum_{k,l} \left( \frac{\mathrm{d}J}{\mathrm{d}t} \right)_{kl} \left( J^{-1} \right)_{lk}.
\]</div>
<p>The elements of the matrices <span class="math notranslate nohighlight">\(\frac{\mathrm{d}J}{\mathrm{d}t}\)</span> and <span class="math notranslate nohighlight">\(J^{-1}\)</span> are given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-5eb6e0b1-634b-40ad-a53a-0a18ad90392e">
<span class="eqno">(34)<a class="headerlink" href="#equation-5eb6e0b1-634b-40ad-a53a-0a18ad90392e" title="Permalink to this equation">¶</a></span>\[\begin{align}

\left( \frac{\mathrm{d}J}{\mathrm{d}t} \right)_{kl} &amp;= \frac{\partial \dot{x}_t^k}{\partial x_0^l} &amp; \left( J^{-1} \right)_{lk} = \frac{\partial x_0^l}{\partial x_t^k},

\end{align}\]</div>
<p>so multiplying them and summing over <span class="math notranslate nohighlight">\(l\)</span> is just the chain rule for <span class="math notranslate nohighlight">\(\frac{\partial \dot{x}_t^k}{\partial x_t^k}\)</span>, leading to</p>
<div class="math notranslate nohighlight">
\[
\frac{\mathrm{d}}{\mathrm{d}t} \mathcal{J}(\textbf{x}_t;\textbf{x}_0) = \mathcal{J}(\textbf{x}_t;\textbf{x}_0) \sum_k \frac{\partial \dot{x}_t^k}{\partial x_t^k}.
\]</div>
<p>For a single particle, the sum over <span class="math notranslate nohighlight">\(k\)</span> gives Eq. <a class="reference internal" href="#equation-pre-incomp">(29)</a>, which we already showed was equal to zero. Alternatively, for every coordinate <span class="math notranslate nohighlight">\(q_t\)</span> in <span class="math notranslate nohighlight">\(\textbf{x}_t\)</span> the term in the sum gives <span class="math notranslate nohighlight">\(\frac{\partial^2 \mathcal{H}}{\partial q_t \partial p_t}\)</span> while for every momentum <span class="math notranslate nohighlight">\(p_t\)</span> we get <span class="math notranslate nohighlight">\(- \frac{\partial^2 \mathcal{H}}{\partial p_t \partial q_t}\)</span> which cancel out to give zero. This concludes the proof that</p>
<div class="math notranslate nohighlight">
\[\frac{\mathrm{d}}{\mathrm{d} t} \mathcal{J}(\textbf{x}_t;\textbf{x}_0) = 0, \]</div>
<p>which means that since <span class="math notranslate nohighlight">\(\mathcal{J}=1\)</span> initially by definition, it will stay conserved along the trajectory, thus proving Eq. <a class="reference internal" href="#equation-incompressibility">(31)</a>.</p>
<p>If you didn’t follow the derivation, do not worry! You will now demonstrate phase space incomressiblity for a simple example.</p>
<div class="tip admonition">
<p class="admonition-title">Active learning</p>
<p>Show that the Eq. <a class="reference internal" href="#equation-incompressibility">(31)</a> is correct for the case of a single particle of mass <span class="math notranslate nohighlight">\(m\)</span> in a harmonic trap of frequency <span class="math notranslate nohighlight">\(w_0\)</span>. In this case, <span class="math notranslate nohighlight">\(\textbf{x} = [q,p]\)</span>. You can use the results of the previous chapter,</p>
<div class="math notranslate nohighlight">
\[ q(t) = q_0 \cos{\omega_0 t} + \frac{p_0}{m \omega_0} \sin{\omega_0 t} \]</div>
<div class="math notranslate nohighlight">
\[ p(t) = p_0 \cos{\omega_0 t} - m \omega_0 q_0 \sin{\omega_0 t} \]</div>
<p>Hint: Compute the Jacobian of the coordinate transformation and show that it is unity.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>In the case of a single particle the Jacobian is a 2x2 matrix,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
J=
\begin{pmatrix}
\frac{\partial q_t}{\partial q_0} &amp; \frac{\partial q_t}{\partial p_0} \\
\frac{\partial p_t}{\partial q_0} &amp; \frac{\partial p_t}{\partial p_0} 
\end{pmatrix}
=
\begin{pmatrix}
\cos{\omega_0 t} &amp; \sin(\omega_0 t) / m \omega_0 \\
- m \omega_0 \sin(\omega_0 t )  &amp; \cos{\omega_0 t}
\end{pmatrix}
\end{split}\]</div>
<p>whose determinant is <span class="math notranslate nohighlight">\(\det{J} = \cos^2{\omega_0 t} + \sin^2(\omega_0 t ) = 1\)</span>.</p>
</div>
</div>
<div class="section" id="equilibrium">
<span id="chap-eq"></span><h2>Equilibrium<a class="headerlink" href="#equilibrium" title="Permalink to this headline">¶</a></h2>
<p>Now we go back to the connection we established between the Poisson bracket of the phase space distribution function with the Hamiltonian, through Eq. <a class="reference internal" href="#equation-liouville2">(30)</a>. We define <strong>thermodynamic equilibrium</strong> as the case when the distribution <span class="math notranslate nohighlight">\(f(\textbf{x})\)</span> does not depend explicitly on time. Eq.<a class="reference internal" href="#equation-liouville2">(30)</a> then reads</p>
<div class="math notranslate nohighlight">
\[
\{ f, \mathcal{H} \}  = 0.
\]</div>
<p>This equation can be solved for <span class="math notranslate nohighlight">\(f(\textbf{x})\)</span> as a function of the Hamiltonian, which we formally denote as</p>
<div class="math notranslate nohighlight">
\[
f(\textbf{x}) = \frac{1}{\mathcal{Z}} \mathcal{F}(\mathcal{H}(\textbf{x})).
\]</div>
<p>The averages of macroscopic observables will then also be time-independent (you might remember this definition from earlier classes for thermodynamic equilibrium), given by</p>
<div class="math notranslate nohighlight" id="equation-ensemble-av-eq">
<span class="eqno">(35)<a class="headerlink" href="#equation-ensemble-av-eq" title="Permalink to this equation">¶</a></span>\[
A = \langle a \rangle_f = \frac{1}{\mathcal{Z}} \int \mathcal{F}(\mathcal{H}(\textbf{x})) \, a(\textbf{x}) \, \mathrm{d} \textbf{x}.
\]</div>
<p>The denominator <span class="math notranslate nohighlight">\(\mathcal{Z}\)</span> is called the <strong>partition function</strong>, which is used to normalize the function <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>, defined as</p>
<div class="math notranslate nohighlight" id="equation-partition-func">
<span class="eqno">(36)<a class="headerlink" href="#equation-partition-func" title="Permalink to this equation">¶</a></span>\[
\mathcal{Z} = \int \mathcal{F}(\mathcal{H}(\textbf{x})) \, \mathrm{d} \textbf{x}.
\]</div>
<p>To proceed and write specific expressions for <span class="math notranslate nohighlight">\(\mathcal{F}\)</span>, we invoke a second postulate, called <strong>the hypothesis of equal <em>a priori</em> probabilities</strong>. In simple terms, it says that for an ensemble of isolated systems, each characterized by the same number of particles, volume and total energy, all microstates have equal probability. That is, the phase space distribution is a constant when the energy is between <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(E + \delta E\)</span> and zero otherwise.</p>
<p>We saw previously that the classical equations of motion for an isolated system under the influence of conservative forces ensure that the total energy is constant. An ensemble composed of such isolated systems is called the <strong>microcanonical ensemble</strong>. Since they are characterized by a constant number of particles, volume and total energy, the ensemble is often denoted by the letters NVE.</p>
<p>According to our second postulate, the equilibrium distribution at the NVE ensemble can be written formally as</p>
<div class="math notranslate nohighlight">
\[
\mathcal{F}(\mathcal{H}(\textbf{x})) \propto \delta (\mathcal{H}(\textbf{x}) - E),
\]</div>
<p>and expectation values are obtained through</p>
<div class="math notranslate nohighlight" id="equation-ensemble-av-nve">
<span class="eqno">(37)<a class="headerlink" href="#equation-ensemble-av-nve" title="Permalink to this equation">¶</a></span>\[
A = \langle a \rangle_E = \frac{ \int \delta (\mathcal{H}(\textbf{x}) - E) \, a(\textbf{x}) \, \mathrm{d} \textbf{x}} {\int \delta (\mathcal{H}(\textbf{x}) - E) \, \mathrm{d} \textbf{x}} .
\]</div>
<p>You have derived in previous courses <span class="math notranslate nohighlight">\(\mathcal{F}(\mathcal{H}(\textbf{x}))\)</span> for other emsembles. We will not repeat this derivation here, but just mention that all of them can be derived from our two postulates by considering the entire ensemble as an isolated system. For the an ensemble of systems with a fixed number of particles, volume and temperature, called the <strong>canonical ensemble</strong>, <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is the famous Boltzmann distribution,</p>
<div class="math notranslate nohighlight">
\[
\mathcal{F}(\mathcal{H}(\textbf{x})) \propto e^{-\beta \mathcal{H} (\textbf{x})}.
\]</div>
<p>and the observables are given by</p>
<div class="math notranslate nohighlight" id="equation-ensemble-av-nvt">
<span class="eqno">(38)<a class="headerlink" href="#equation-ensemble-av-nvt" title="Permalink to this equation">¶</a></span>\[
A = \langle a \rangle_{\beta} = \frac{ \int e^{-\beta \mathcal{H} (\textbf{x})} \, a(\textbf{x}) \, \mathrm{d} \textbf{x}} {\int e^{-\beta \mathcal{H} (\textbf{x})} \, \mathrm{d} \textbf{x}} .
\]</div>
<p>The canonical ensemble is usually denoted by the letters NVT.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "BarakHirshberg/MolecularSimulations",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="ClassicalMech.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Classical mechanics</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="MolecularDynamics.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Molecular dynamics</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Dr. Barak Hirshberg, School of Chemistry, Tel Aviv University, Tel Aviv 6997801, Israel.<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>
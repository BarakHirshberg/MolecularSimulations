
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Classical mechanics &#8212; Molecular Simulations - 0351-4057</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ClassicalMech';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Basic statistical mechanics" href="StatMech.html" />
    <link rel="prev" title="Introduction" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/tau_logo.jpg" class="logo__image only-light" alt="Molecular Simulations - 0351-4057 - Home"/>
    <script>document.write(`<img src="_static/tau_logo.jpg" class="logo__image only-dark" alt="Molecular Simulations - 0351-4057 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Classical mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="StatMech.html">Basic statistical mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="MolecularDynamics.html">Molecular dynamics</a></li>
<li class="toctree-l1"><a class="reference internal" href="ProjPrerequisites.html">Prerequisites for numerical projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="NumProjI.html">Numerical project I - MD simulation (NVE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="MonteCarlo.html">Monte Carlo</a></li>
<li class="toctree-l1"><a class="reference internal" href="NumProjII.html">Numerical Project II - MC simulation (NVT)</a></li>
<li class="toctree-l1"><a class="reference internal" href="NumProjIII.html">Final project</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/BarakHirshberg/book/master/v2/gh/BarakHirshberg/MolecularSimulations/master?urlpath=tree/ClassicalMech.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/BarakHirshberg/MolecularSimulations/blob/master/ClassicalMech.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BarakHirshberg/MolecularSimulations" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BarakHirshberg/MolecularSimulations/issues/new?title=Issue%20on%20page%20%2FClassicalMech.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/ClassicalMech.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Classical mechanics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newton-s-equations">Newton’s equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-space">Phase space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrangian-mechanics">Lagrangian mechanics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian-mechanics">Hamiltonian mechanics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-action">The action</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="classical-mechanics">
<span id="chap-classmech"></span><h1>Classical mechanics<a class="headerlink" href="#classical-mechanics" title="Link to this heading">#</a></h1>
<section id="newton-s-equations">
<span id="sec-newton"></span><h2>Newton’s equations<a class="headerlink" href="#newton-s-equations" title="Link to this heading">#</a></h2>
<p>You are all familiar with this formulation of classical mechanics,
so we will go over it very briefly.
In his masterpiece “Principia”, first published in 1687(!),
Newton formulated his three celebrated laws of motion.
The first two can be succinctly summarized in the equation,</p>
<div class="math notranslate nohighlight" id="equation-newton2nd">
<span class="eqno">(1)<a class="headerlink" href="#equation-newton2nd" title="Link to this equation">#</a></span>\[
m \ddot{ \textbf{r} } = \textbf{F},
\]</div>
<p>where <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\( \textbf{r}(t) = [x(t), y(t), z(t)] \)</span> are the mass and
the Cartesian position vector of the particle, respectively. The single and double
dot represent the first and second time-derivatives, respectively,
and <span class="math notranslate nohighlight">\(\textbf{F}\)</span> is the force acting on the particle.
We will denote vectors by bold letters throughout the course.
Eq. <a class="reference internal" href="#equation-newton2nd">(1)</a>
is a second-order differential equation.
To solve it, we require two <strong>initial conditions</strong>, namely,
the position and velocity at <span class="math notranslate nohighlight">\(t=0\)</span>. The solution of the equation
specifying the position of a particle in time (which also gives the
velocity by differentiation) is called a <strong>trajectory</strong>.</p>
<p>Eq. <a class="reference internal" href="#equation-newton2nd">(1)</a> shows that the acceleration produced by the force
<span class="math notranslate nohighlight">\(\textbf{F}\)</span> acting on the particle is equal to the force divided by the
particle’s mass, also known as Newton’s second law or Newton’s equation of
motion. It also embodies the first law which states that in the
absence of force, a body will remain at rest or move in a straight
line with constant velocity. This can be seen by setting
<span class="math notranslate nohighlight">\(\textbf{F} = 0\)</span>  in Eq. <a class="reference internal" href="#equation-newton2nd">(1)</a> and integrating twice to get
<span class="math notranslate nohighlight">\(\dot{ \textbf{r} } =  \textbf{v}\)</span> and
<span class="math notranslate nohighlight">\(\textbf{r} = \textbf{r}(0) + \textbf{v}t\)</span>. Newton’s third law states
that “for every action, there is an equal and opposite reaction”,
i.e., that if <span class="math notranslate nohighlight">\(\textbf{F}_{12}\)</span> is the force that particle 1 exerts
on particle 2, then</p>
<div class="math notranslate nohighlight" id="equation-newton3rd">
<span class="eqno">(2)<a class="headerlink" href="#equation-newton3rd" title="Link to this equation">#</a></span>\[
      \textbf{F}_{21} = -\textbf{F}_{12}.
\]</div>
<div class="tip admonition">
<p class="admonition-title">Active learning</p>
<p>Solve Newton’s equation of motion for a single particle of mass <span class="math notranslate nohighlight">\(m\)</span> in a one-dimensional harmonic trap with frequency <span class="math notranslate nohighlight">\(\omega_0\)</span>. Use the initial conditions <span class="math notranslate nohighlight">\(q(0) = q_0 \)</span> and <span class="math notranslate nohighlight">\( v(0) = v_0\)</span>.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>The equation to solve is</p>
<div class="math notranslate nohighlight">
\[ m\ddot{q} = -kq = -m \omega_0 ^2 q. \]</div>
<p>Guess <span class="math notranslate nohighlight">\( q(t) = Ae^{rt} + Be^{-rt}  \)</span> to get</p>
<div class="math notranslate nohighlight">
\[ \dot{q}(t) = Are^{rt} - Bre^{-rt}, \]</div>
<div class="math notranslate nohighlight">
\[ \ddot{q}(t) = Ar^2 e^{rt} + Br^2 e^{-rt} = r^2 q(t),  \]</div>
<div class="math notranslate nohighlight">
\[ r = i\omega_0. \]</div>
<p>So</p>
<div class="math notranslate nohighlight">
\[ q(t) = A e^{i\omega_0 t} + B e^{-i\omega_0 t} = (A+B) \cos{\omega_0 t} + i (A-B) \sin{\omega_0 t}. \]</div>
<div class="math notranslate nohighlight">
\[ v(t) = i \omega_0 \left( A e^{i\omega_0 t} - B e^{-i\omega_0 t} \right) = i \omega_0 (A-B) \cos{\omega_0 t} - \omega_0 (A+B) \sin{\omega_0 t}. \]</div>
<p>From the initial conditions, we get <span class="math notranslate nohighlight">\(A+B = q_0\)</span> and <span class="math notranslate nohighlight">\(i (A-B) = v_0 / \omega_0\)</span>, which gives</p>
<div class="math notranslate nohighlight">
\[ q(t) = q_0 \cos{\omega_0 t} + \frac{v_0}{\omega_0} \sin{\omega_0 t} \]</div>
<div class="math notranslate nohighlight">
\[ v(t) = v_0 \cos{\omega_0 t} - \omega_0 q_0 \sin{\omega_0 t} \]</div>
</div>
<p>For a collection for <span class="math notranslate nohighlight">\(N\)</span> particles, Newton’s equations of motion are</p>
<div class="math notranslate nohighlight" id="equation-newton2nd-n">
<span class="eqno">(3)<a class="headerlink" href="#equation-newton2nd-n" title="Link to this equation">#</a></span>\[
      m \ddot{\textbf{r}}_j = \textbf{F}_j,
\]</div>
<p>where <span class="math notranslate nohighlight">\(j=1,...,N\)</span> and the force acting on particle <span class="math notranslate nohighlight">\(j\)</span> depends on the coordinates of all particles, <span class="math notranslate nohighlight">\(\textbf{F}_j(\textbf{r}_1,...,\textbf{r}_N)\)</span>. We define <strong>conservative forces</strong> as those that are the gradient some potential energy,</p>
<div class="math notranslate nohighlight" id="equation-f-cons">
<span class="eqno">(4)<a class="headerlink" href="#equation-f-cons" title="Link to this equation">#</a></span>\[
      \textbf{F}_j = -\nabla_j U(\textbf{r}_1,...,\textbf{r}_N).
\]</div>
<p>The gradient <span class="math notranslate nohighlight">\(\nabla_j = [\frac{\partial}{\partial x_j}, \frac{\partial}{\partial y_j}, \frac{\partial}{\partial z_j}]\)</span> is sometimes also denoted as <span class="math notranslate nohighlight">\(\frac{\partial}{\partial \textbf{r}_j}\)</span>.
The name conservative forces comes from the fact that the total energy is conserved throughout the classical trajectory for such forces.</p>
<div class="tip admonition">
<p class="admonition-title">Active learning</p>
<p>Prove that Newton’s equations conserve the total energy <span class="math notranslate nohighlight">\(E = \frac{1}{2} \sum_{j=1}^N m_j \dot{ \textbf{r}} _j^2 + U(\textbf{r}_1,...,\textbf{r}_N)\)</span>. Hint: Show that its time derivative is zero.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="math notranslate nohighlight">
\[E = \frac{1}{2} \sum_{j=1}^N m_j \dot{ \textbf{r} }_j^2 + U(\textbf{r}_1,...,\textbf{r}_N)\]</div>
<div class="math notranslate nohighlight">
\[ \frac{dE}{dt} = \sum_{j=1}^N m_j \dot{ \textbf{r} }_j \cdot \ddot{\textbf{r}}_j + \frac{U(\textbf{r}_1,...,\textbf{r}_N)}{dt} \]</div>
<p>We use the chain rule on the second term, to get</p>
<div class="math notranslate nohighlight">
\[ \frac{dE}{dt} = \sum_{j=1}^N m_j \dot{\textbf{r}}_j \cdot \ddot{\textbf{r}}_j + \sum_{j=1}^N \nabla_j U \cdot \dot{\textbf{r}}_j\]</div>
<div class="math notranslate nohighlight">
\[ \frac{dE}{dt} = \sum_{j=1}^N \dot{\textbf{r}}_j \cdot (m_j \ddot{\textbf{r}}_j + \nabla_j U) = 0 \]</div>
<p>where the last step used Newton’s laws of motion, Eq. <a class="reference internal" href="#equation-newton2nd-n">(3)</a>, and the definition of conservative forces, Eq. <a class="reference internal" href="#equation-f-cons">(4)</a>.</p>
</div>
<p id="discussion">We require the initial positions and velocities of all <span class="math notranslate nohighlight">\(N\)</span> particles to solve Eq. <a class="reference internal" href="#equation-newton2nd-n">(3)</a>. In practice, however, the exact many-body forces are  complicated, nonlinear functions and the resulting dynamics are highly complex. Any attempt to find an analytic solution to the equations of motion of a many-body system is therefore futile. Moreover, if we give up trying to obtain an analytic solution and are content with solving Eq. <a class="reference internal" href="#equation-newton2nd-n">(3)</a> numerically for a macroscopic system with <span class="math notranslate nohighlight">\(\sim 10^{23}\)</span> particles, it would require more computational resources than are currently (or in the foreseeable future) available. This infamous problem is called the “n-body problem” when the interaction between the particles is gravitational and it is still an area of active research in <a class="reference external" href="https://www.americanscientist.org/article/the-100-billion-body-problem">Astronomy</a>. So, is all hope lost? No! The essence of MD simulations is to instead solve Eq. <a class="reference internal" href="#equation-newton2nd-n">(3)</a> numerically for a large, but much smaller, number of particles, typically ranging between <span class="math notranslate nohighlight">\(100-10^6\)</span>, typically in a box of given volume under some specified boundary conditions (representing a solid, for example, more about this later). It turns out that this approach works remarkably well, and many properties converge to their bulk values for this much smaller number of particles. Before describing MD simulations in detail, we first introduce the concept of phase space, and then look into alternative formulations of classical mechanics which will be of use in the following lessons.</p>
</section>
<section id="phase-space">
<span id="sec-phase-space"></span><h2>Phase space<a class="headerlink" href="#phase-space" title="Link to this heading">#</a></h2>
<p>The solution to Newton’s equations of motion specify the positions <span class="math notranslate nohighlight">\(\textbf{r}(t)\)</span> and velocities <span class="math notranslate nohighlight">\(\textbf{v}(t)\)</span> of the particles at every time, given we know their value at some instance (usually, <span class="math notranslate nohighlight">\(t=0\)</span>). In statistical mechanics and quantum mechanics it turns out to be more convenient to work with the momenta,</p>
<div class="math notranslate nohighlight" id="equation-momenta">
<span class="eqno">(5)<a class="headerlink" href="#equation-momenta" title="Link to this equation">#</a></span>\[
\textbf{p}_j(t) = m_j \textbf{v}_j(t) = m_j \dot{\textbf{r}}_j(t).    
\]</div>
<p>Eq. <a class="reference internal" href="#equation-newton2nd-n">(3)</a> can be written in terms of the momenta as well,</p>
<div class="math notranslate nohighlight" id="equation-newton2nd-n-p">
<span class="eqno">(6)<a class="headerlink" href="#equation-newton2nd-n-p" title="Link to this equation">#</a></span>\[
      \dot{\textbf{p}}_j = \textbf{F}_j.
\]</div>
<p>This equation already tells us something very interesting. When there is no total force acting on the particles,<span class="math notranslate nohighlight">\(\sum_{j=1}^N \dot{\textbf{p}}_j =  \sum_{j=1}^N \textbf{F}_j = 0\)</span> and the total linear momentum <span class="math notranslate nohighlight">\(\textbf{P} = \sum_{j=1}^N \textbf{p}_j\)</span> is conserved.</p>
<p>At any moment in time, the <strong>microscopic state</strong> (“microstate”) of the system is specified by <span class="math notranslate nohighlight">\(6N\)</span> numbers - the components of the position and momentum vectors of all particles. These numbers can be considered as a point in a <span class="math notranslate nohighlight">\(6N\)</span> dimensional space, called <strong>phase space</strong>. We will denote a point in phase space as</p>
<div class="math notranslate nohighlight" id="equation-x-phase-space">
<span class="eqno">(7)<a class="headerlink" href="#equation-x-phase-space" title="Link to this equation">#</a></span>\[
    \textbf{x}(t) = [\textbf{r}_1(t), ..., \textbf{r}_N(t),\textbf{p}_1(t),...,\textbf{p}_N(t)].
\]</div>
<p>A trajectory obtained from the solution of Newton’s equations of motion defines a parametric path in phase space. Visualizing it in a <span class="math notranslate nohighlight">\(6N\)</span> dimensional space is inconvenient, but we can do it for a single particle moving in one dimension. Let us look at the phase space path for a single particle of mass <span class="math notranslate nohighlight">\(m\)</span> in a one-dimensional harmonic trap with frequency <span class="math notranslate nohighlight">\(\omega_0\)</span>. We will show that the phase space trajectory is an ellipse, whose size is determined by the initial conditions which define the conserved energy. The shape of the ellipse is determined by the mass of the particle and the trap frequency.</p>
<div class="tip admonition">
<p class="admonition-title">Active learning</p>
<p>Show that the trajectory for a single particle of mass <span class="math notranslate nohighlight">\(m\)</span> in a one-dimensional harmonic trap with frequency <span class="math notranslate nohighlight">\(\omega_0\)</span> is an ellipse in phase space. Use the initial conditions <span class="math notranslate nohighlight">\(q(0)=q_0\)</span> and <span class="math notranslate nohighlight">\(v(0)=0\)</span>. Hint: Use energy conservation.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>We already obtained the solution for <span class="math notranslate nohighlight">\(q(0)=q_0\)</span> and <span class="math notranslate nohighlight">\(v(0)=0\)</span>,</p>
<div class="math notranslate nohighlight">
\[ q(t) = q_0 \cos(\omega_0 t ), \]</div>
<div class="math notranslate nohighlight">
\[ p(t) = - m\omega_0 q_0 \sin(\omega_0 t ) .\]</div>
<p>We also showed that the total energy is conserved, equal to its initial value,</p>
<div class="math notranslate nohighlight">
\[E(t) = E = \frac{1}{2} m \omega_0^2 q_0^2.\]</div>
<p>But, on the other hand,</p>
<div class="math notranslate nohighlight">
\[E(t) = \frac{p^2(t)}{2m} + \frac{1}{2} m \omega_0^2 q^2(t),\]</div>
<p>which shows that the trajectory is an ellipse in phase space,</p>
<div class="math notranslate nohighlight">
\[  \frac{q^2(t)}{q^2_0} + \frac{p^2(t)}{m^2 \omega^2_0 q^2_0} = 1,\]</div>
<p>with the semi-major and semi-minor axes being <span class="math notranslate nohighlight">\(a=q_0\)</span> and <span class="math notranslate nohighlight">\(b=m \omega_0 q_0 \)</span>, respectively.</p>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;numpy&#39;
</pre></div>
</div>
</div>
</div>
<p>Now that we have mastered Newtonian Mechanics and the phase space representation of trajectories, we will move on to two equivalent formulations of classical mechanics which are more convenient for molecular simulations.</p>
</section>
<section id="lagrangian-mechanics">
<span id="sec-lagrange"></span><h2>Lagrangian mechanics<a class="headerlink" href="#lagrangian-mechanics" title="Link to this heading">#</a></h2>
<p>We will first present the formalism of Lagrangian mechanics and only later show how to derive it, and all other formulations, from one general axiom called Hamilton’s principle.</p>
<p>We define the <strong>Lagrangian</strong> as the difference between the kinetic and potential energy of the system, expressed in terms of the Cartesian positions and velocities,</p>
<div class="math notranslate nohighlight" id="equation-lagrangian">
<span class="eqno">(8)<a class="headerlink" href="#equation-lagrangian" title="Link to this equation">#</a></span>\[
      \mathcal{L}
      (\textbf{r}_1,...,\textbf{r}_N,\dot{\textbf{r}}_1,...,\dot{\textbf{r}}_N) = K(\dot{\textbf{r}}_1,...,\dot{\textbf{r}}_N) - U(\textbf{r}_1,...,\textbf{r}_N),
\]</div>
<p>where the kinetic energy is given by</p>
<div class="math notranslate nohighlight" id="equation-kinetic">
<span class="eqno">(9)<a class="headerlink" href="#equation-kinetic" title="Link to this equation">#</a></span>\[
    K(\dot{\textbf{r}}_1,...,\dot{\textbf{r}}_N) = 
    \frac{1}{2} \sum_{j=1}^N m_j \dot{\textbf{r}}^2_j.
\]</div>
<p>The classical equations of motion can be recovered from <span class="math notranslate nohighlight">\(\mathcal{L}\)</span> through the celebrated <strong>Euler-Lagrange equations</strong>,</p>
<div class="math notranslate nohighlight" id="equation-el-eq">
<span class="eqno">(10)<a class="headerlink" href="#equation-el-eq" title="Link to this equation">#</a></span>\[
    \frac{\mathrm{d}}{\mathrm{d}t} \frac{\partial \mathcal{L}}{\partial \dot{\textbf{r}}_j} = \frac{\partial \mathcal{L}}{\partial \textbf{r}_j}.
\]</div>
<div class="tip admonition">
<p class="admonition-title">Active learning</p>
<p>Show that for the Lagrangian of Eq. <a class="reference internal" href="#equation-lagrangian">(8)</a> and the Kinetic energy defined in Eq. <a class="reference internal" href="#equation-kinetic">(9)</a>, Euler-Lagrange equations are equivalent to Newton’s equations of motion for conservative forces.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \mathcal{L}}{\partial \textbf{r}_j} = -\nabla_j U = \textbf{F}_j  \]</div>
<div class="math notranslate nohighlight">
\[ \frac{\partial \mathcal{L}}{\partial \dot{\textbf{r}}_j} = \frac{\partial K}{\partial \dot{\textbf{r}}_j} = m_j \dot{\textbf{r}}_j \]</div>
<div class="math notranslate nohighlight">
\[\frac{\mathrm{d}}{\mathrm{d}t} \frac{\partial \mathcal{L}}{\partial \dot{\textbf{r}}_j} = m_j \ddot{\textbf{r}}_j \]</div>
<p>Which, upon substitution into Eq. <a class="reference internal" href="#equation-el-eq">(10)</a>, gives Newton’s equations of motion, Eq. <a class="reference internal" href="#equation-newton2nd-n">(3)</a>.</p>
</div>
<p>So, why do we need Lagrangian Mechanics? In what way are they more useful than Newtonian Mechanics? The short (and insufficient) answer is that they allow us to write equations of motions easily when non-Cartesian coordinates are natural to the problem. The new coordinates are often called <strong>generalized coordinates</strong>. This is because the Euler-Lagrange equations, Eq. <a class="reference internal" href="#equation-el-eq">(10)</a>, do not change under such <strong>point transformations</strong>. Lagrangian mechanics also allow us to handle constraints in a much more straightforward manner than Newtonian dynamics. Finally, Lagrangian mechanics are convenient to prove a remarkable result - that conservation laws are related to symmetry! This is a topic of some depth, and we will barely scratch the surface with a simple example.</p>
<p>Consider a pendulum composed of a mass <span class="math notranslate nohighlight">\(m\)</span> attached to a string of fixed length <span class="math notranslate nohighlight">\(l\)</span> hanging off a surface by an angle <span class="math notranslate nohighlight">\(\phi\)</span>.
In Newtonian Mechanics, we would have first considered the different forces: gravity applies a force <span class="math notranslate nohighlight">\(m\textbf{g}\)</span> directed along the <span class="math notranslate nohighlight">\(y\)</span> axis and the string applies a radial force <span class="math notranslate nohighlight">\(\textbf{T}\)</span>, which is unknown, to compensate for the radial component of the gravitational pull. In other words, the tension force is required to make sure the mass doesn’t move in the radial direction, i.e., that the constraint on the length of the spring is fulfilled. Then, we would write down the equations of motions for each force component and after some algebraic manipulations, we would get the equations for the dynamics of the angle <span class="math notranslate nohighlight">\(\phi\)</span> and an expression for the tension force. Let us see how simple this process gets with the Lagrangian formalism instead.</p>
<p>We define two generalized coordinates, <span class="math notranslate nohighlight">\( x = l\sin{\phi}\)</span> and <span class="math notranslate nohighlight">\( y= l \cos{\phi}.\)</span> The kinetic energy is then given by,</p>
<div class="math notranslate nohighlight">
\[
K = \frac{1}{2} m (\dot{x}^2 + \dot{y}^2) = \frac{1}{2} m l^2 \dot{\phi}^2 (\cos^2{\phi} + \sin^2{\phi}) = \frac{1}{2} m l^2 \dot{\phi}^2,
\]</div>
<p>and the potential energy by,</p>
<div class="math notranslate nohighlight">
\[
    U = m g (l-y) = m g l(1-\cos{\phi}).
\]</div>
<p>The Lagrangian is then,</p>
<div class="math notranslate nohighlight">
\[
    \mathcal{L} = \frac{1}{2} m l^2 \dot{\phi}^2 - m g l(1-\cos{\phi}),
\]</div>
<p>which results in the Euler-Lagrange equation for <span class="math notranslate nohighlight">\(\phi\)</span>,</p>
<div class="math notranslate nohighlight">
\[
    \ddot{\phi} = - \frac{g}{l} \sin{\phi}.
\]</div>
<p>This is a non-linear differential equation which is generally very hard to solve.
What you did in your first-year mechanics course is to assume that <span class="math notranslate nohighlight">\(\phi\)</span> is small so that <span class="math notranslate nohighlight">\(\sin{\phi} \approx \phi\)</span>, which leads to simple harmonic motion with frequency <span class="math notranslate nohighlight">\(\omega = \sqrt{\frac{g}{l}}\)</span>. Look at how easy it was to derive it using the Lagrangian formulation!
We now consider another formulation of classical mechanics, due to Hamilton, which you already encountered in quantum mechanics but probably were not aware of its utility in the classical context.</p>
</section>
<section id="hamiltonian-mechanics">
<span id="sec-hamilton"></span><h2>Hamiltonian mechanics<a class="headerlink" href="#hamiltonian-mechanics" title="Link to this heading">#</a></h2>
<p>While Lagrangian mechanics is based on a description of the dynamics of a system in terms of the positions and velocities, the Hamiltonian formulation is intimately connected to the phase space representation we introduced in Section <a class="reference internal" href="#sec-phase-space"><span class="std std-ref">Phase space</span></a>. We previously defined the Cartesian momentum, <span class="math notranslate nohighlight">\(\textbf{p}_j = m_j \dot{\textbf{r}}_j\)</span> in Eq. <a class="reference internal" href="#equation-momenta">(5)</a>. A wider definition is to consider a <strong>generalized momentum</strong>,</p>
<div class="amsmath math notranslate nohighlight" id="equation-8106eb6c-0d95-461d-8924-1e47114e78d5">
<span class="eqno">(11)<a class="headerlink" href="#equation-8106eb6c-0d95-461d-8924-1e47114e78d5" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \textbf{p}_j = \frac{\partial \mathcal{L}}{\partial \dot{\textbf{q}}_j},
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\textbf{q}_j\)</span> is some generalized coordinate. When we write the Lagrangian in Cartesian coordinates, <span class="math notranslate nohighlight">\(\textbf{r}_j\)</span>, this definition reduces to Eq. <a class="reference internal" href="#equation-momenta">(5)</a>, but it holds for any choice of coordinates! (Remember, this was a major strength also of the Lagrangian formulation). For example, in the case of the pendulum we considered above, <span class="math notranslate nohighlight">\(p_\phi = m l^2 \dot{\phi}\)</span>.</p>
<p>The <strong>Hamiltonian</strong> is then defined<a class="footnote-reference brackets" href="#footnote1" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> as</p>
<div class="amsmath math notranslate nohighlight" id="equation-68aaacdc-b080-45b6-8674-f9c60410de02">
<span class="eqno">(12)<a class="headerlink" href="#equation-68aaacdc-b080-45b6-8674-f9c60410de02" title="Permalink to this equation">#</a></span>\[\begin{equation}
\label{Hamiltonian_def}
    \mathcal{H}(\textbf{q}_1,...,\textbf{q}_N,\textbf{p}_1,...,\textbf{p}_N) = \sum_{j=1}^N \textbf{p}_j \cdot \dot{\textbf{q}}_j(\textbf{p}_j) - \mathcal{L} \left (\textbf{q}_1,...,\textbf{q}_N,\dot{\textbf{q}}_1(\textbf{p}_1),...,\dot{\textbf{q}}_N(\textbf{p}_N) \right ),
\end{equation}\]</div>
<p>and the equations of motion are called <strong>Hamilton’s equations</strong>,</p>
<div class="math notranslate nohighlight" id="equation-hamilton-eq">
<span class="eqno">(13)<a class="headerlink" href="#equation-hamilton-eq" title="Link to this equation">#</a></span>\[
    \dot{\textbf{q}}_j = \frac{\partial \mathcal{H}}{\partial \textbf{p}_j}, \dot{\textbf{p}}_j = - \frac{\partial \mathcal{H}}{\partial \textbf{q}_j} .
\]</div>
<div class="tip admonition">
<p class="admonition-title">Active learning</p>
<p>Write the Hamiltonian for the pendulum we considered above. Show that it is equal to the total energy of the system.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="math notranslate nohighlight">
\[ p_\phi = \frac{\partial \mathcal{L}}{\partial { \dot{\phi} }_j} = m l^2 \dot{\phi} \]</div>
<div class="math notranslate nohighlight">
\[ \dot{\phi} = \frac{p_\phi}{m l^2}\]</div>
<div class="math notranslate nohighlight">
\[ \mathcal{L} = \frac{1}{2} m l^2 \dot{\phi}^2 - m g l(1-\cos{\phi}) \]</div>
<div class="math notranslate nohighlight">
\[ \mathcal{L} = \frac{1}{2} \frac{p^2_\phi}{m l^2} - m g l(1-\cos{\phi}) \]</div>
<div class="math notranslate nohighlight">
\[ \mathcal{H} = p_\phi \dot{\phi} - \mathcal{L} \]</div>
<div class="math notranslate nohighlight">
\[ \mathcal{H} = \frac{p^2_\phi}{m l^2} - \mathcal{L} \]</div>
<div class="math notranslate nohighlight">
\[ \mathcal{H} = \frac{1}{2}\frac{p^2_\phi}{m l^2} + m g l(1-\cos{\phi}) \]</div>
<p>Which is equivalent to the total energy</p>
<div class="math notranslate nohighlight">
\[ K + U = \frac{1}{2} m l^2 \dot{\phi}^2 + m g l(1-\cos{\phi}) \]</div>
</div>
<p>If we choose to work in Cartesian coordinates, <span class="math notranslate nohighlight">\(\dot{\textbf{r}}_j(\textbf{p}_j) = \textbf{p}_j / m_j \)</span>, according to Eq. <a class="reference internal" href="#equation-momenta">(5)</a>, we get</p>
<div class="math notranslate nohighlight" id="equation-hamiltonian-cu">
<span class="eqno">(14)<a class="headerlink" href="#equation-hamiltonian-cu" title="Link to this equation">#</a></span>\[
    \mathcal{H}(\textbf{r}_1,...,\textbf{r}_N,\textbf{p}_1,...,\textbf{p}_N) = \sum_{i=1}^N \frac{\textbf{p}_j^2}{2 m_j} + U(\textbf{r}_1,...,\textbf{r}_N),
\]</div>
<p>which shows that the Hamiltonian is just the total energy of the system in terms of the Cartesian positions and momenta,</p>
<div class="amsmath math notranslate nohighlight" id="equation-34a6ae91-f368-4420-a61b-295d047620bf">
<span class="eqno">(15)<a class="headerlink" href="#equation-34a6ae91-f368-4420-a61b-295d047620bf" title="Permalink to this equation">#</a></span>\[\begin{equation}
    \mathcal{H}(\textbf{r}_1,...,\textbf{r}_N,\textbf{p}_1,...,\textbf{p}_N) = K(\dot{\textbf{r}}_1,...,\dot{\textbf{r}}_N) + U(\textbf{r}_1,...,\textbf{r}_N).
\end{equation}\]</div>
<p>Hamilton’s equations in this case also reduce to Newton’s equations of motion.</p>
<div class="tip admonition">
<p class="admonition-title">Active learning</p>
<p>Show that for the Hamiltonian of Eq. <a class="reference internal" href="#equation-hamiltonian-cu">(14)</a>, Hamilton’s equations are equivalent to Newton’s equations of motion for conservative forces.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\dot{\textbf{r}}_j &amp;= \frac{\partial \mathcal{H}}{\partial \textbf{p}_j} = \frac{\textbf{p}_j}{m_j} &amp;
\dot{\textbf{p}}_j &amp;= - \frac{\partial \mathcal{H}}{\partial \textbf{r}_j} = -\nabla_j U
\end{align*}\]</div>
<p>If we take the derivative of the left equation and substitute it into the right one, we get Newton’s equations of motion, Eq. <a class="reference internal" href="#equation-newton2nd-n">(3)</a>.</p>
</div>
<p>We are now in a position to appreciate a result of the Hamiltonian formalism which may ring a bell. It allows us to write a specific condition for when some quantity, <span class="math notranslate nohighlight">\(g(\textbf{q}_1,...,\textbf{q}_N,\textbf{p}_1,...,\textbf{p}_N)\)</span>, a function of the phase space variables, is conserved.
We write the time derivative of <span class="math notranslate nohighlight">\(g\)</span> using the chain rule as</p>
<div class="math notranslate nohighlight">
\[
\frac{\mathrm{d} g}{\mathrm{d} t} = \sum_{j=1}^N \left[ \frac{\partial g}{\partial \textbf{q}_j}  \cdot \dot{\textbf{q}}_j + \frac{\partial g}{\partial \textbf{p}_j}  \cdot \dot{\textbf{p}}_j \right].
\]</div>
<p>Using Hamilton’s equations, we can write</p>
<div class="math notranslate nohighlight" id="equation-poisson">
<span class="eqno">(16)<a class="headerlink" href="#equation-poisson" title="Link to this equation">#</a></span>\[
    \frac{\mathrm{d} g}{\mathrm{d} t} = \sum_{j=1}^N \left[ \frac{\partial g}{\partial \textbf{q}_j}  \cdot \frac{\partial \mathcal{H}}{\partial \textbf{p}_j} - \frac{\partial g}{\partial \textbf{p}_j}  \cdot \frac{\partial \mathcal{H}}{\partial \textbf{q}_j} \right] \equiv \left \{ g,\mathcal{H} \right \},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\left \{ u, v \right \}\)</span> are termed the <strong>Poisson bracket</strong> between the functions <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span>. Eq. <a class="reference internal" href="#equation-poisson">(16)</a> shows that a quantity <span class="math notranslate nohighlight">\(g\)</span> is conserved when its Poisson bracket with the Hamiltonian is zero. If you are scratching your head thinking, “Hey, this looks familiar!”, you are right. Indeed, the commutator between operators in quantum mechanics plays a similar role to that of the Poisson bracket between functions of phase space variables in classical mechanics. Unfortunately, we can’t discuss this in more detail. Since the Hamiltonian of Eq. <a class="reference internal" href="#equation-hamiltonian-cu">(14)</a> commutes with itself (and assuming it is time-independent, as we have been doing), this constitutes another proof of the conservation of energy along classical trajectories for conservative forces.</p>
<div class="tip admonition">
<p class="admonition-title">Active learning</p>
<p>Prove that for a system of <span class="math notranslate nohighlight">\(N\)</span> particles with no external forces acting on them, <span class="math notranslate nohighlight">\(\sum_{j=1}^N \textbf{F}_j = 0\)</span>, the total momentum is conserved.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>The total momentum is <span class="math notranslate nohighlight">\(\textbf{P} = \sum_{k=1}^N \textbf{p}_k\)</span>. Therefore,</p>
<div class="math notranslate nohighlight">
\[ \left \{ \textbf{P},\mathcal{H} \right \} = \sum_{k=1}^N \left \{ \textbf{p}_k,\mathcal{H} \right \} = \sum_{k=1}^N \sum_{j=1}^N \left [ \frac{\partial \textbf{p}_k}{\partial \textbf{q}_j}  \cdot \frac{\partial \mathcal{H}}{\partial \textbf{p}_j} - \frac{\partial \textbf{p}_k }{\partial \textbf{p}_j}  \cdot \frac{\partial \mathcal{H}}{\partial \textbf{q}_j} \right ]. \]</div>
<p>Since the momenta and coordinates are independent variables in the Hamiltonian formalism,</p>
<div class="math notranslate nohighlight">
\[  \left \{ \textbf{P},\mathcal{H} \right \} = - \sum_{k=1}^N \sum_{j=1}^N \frac{\partial \mathcal{H}}{\partial \textbf{q}_j} \delta_{jk} = - \sum_{k=1}^N \frac{\partial \mathcal{H}}{\partial \textbf{q}_k} = - \sum_{k=1}^N \frac{\partial U}{\partial \textbf{q}_k} = 0. \]</div>
</div>
</section>
<section id="the-action">
<span id="sec-action"></span><h2>The action<a class="headerlink" href="#the-action" title="Link to this heading">#</a></h2>
<p>We have so far presented the classical equations of motions, be it in the Hamiltonian or the Lagrangian formalism, without deriving them. The question arises - can we derive the Euler-Lagrange equations, and from them Hamilton’s and Newton’s equations, from some underlying general principle? The answer is positive.</p>
<p>To see how, we need to define the <strong>Action</strong> integral,</p>
<div class="math notranslate nohighlight" id="equation-action">
<span class="eqno">(17)<a class="headerlink" href="#equation-action" title="Link to this equation">#</a></span>\[
    S\left[  \textbf{q}_1,...,\textbf{q}_N,  \dot{\textbf{q}}_1,...,\dot{\textbf{q}}_N \right] = \int_{t_1}^{t_2} \mathcal{L} (\textbf{q}_1(t),...,\textbf{q}_N(t),  \dot{\textbf{q}}_1(t),...,\dot{\textbf{q}}_N(t)) \mathrm{d}t.
\]</div>
<p>For brevity, we will denote collectively <span class="math notranslate nohighlight">\(\textbf{q}_1(t),...,\textbf{q}_N(t)\)</span> as <span class="math notranslate nohighlight">\(\textbf{Q}(t) \)</span> and similarly for the time derivatives.
Note that while the Lagrangian and Hamiltonian are <strong>functions</strong> of the coordinates and velocities or momenta, the action is a <strong>functional</strong>. A functional is a mathematical object that takes a function as input and maps it uniquely to some number, similarly to how a function takes one number as input and maps it uniquely to another number. Every <span class="math notranslate nohighlight">\(N\)</span>-particles trajectory, <span class="math notranslate nohighlight">\(\textbf{Q}(t), \dot{\textbf{Q}}(t)\)</span>, that fulfills the boundary conditions, (i.e., starts from <span class="math notranslate nohighlight">\(\textbf{Q}(t_1)\)</span> with <span class="math notranslate nohighlight">\(\dot{\textbf{Q}}(t_1)\)</span> and ends at <span class="math notranslate nohighlight">\(\textbf{Q}(t_2)\)</span> with <span class="math notranslate nohighlight">\(\dot{\textbf{Q}}(t_2))\)</span>, uniquely defines the time evolution of the Lagrangian which in turn translates to a specific value of the action. Alternatively, the difference between a functional and a function is that the action depends on all values of the trajectory between two points while the Lagrangian and Hamiltonian depend only on the value of the trajectory in some specific instance in time.</p>
<!-- ![Action Integral]("action.jpg") -->
<!-- ```{image} "action.jpg"
:alt: action
:class: bg-primary mb-1
:width: 200px
:align: center
``` -->
<p>It turns out that the Euler-Lagrange equations can be derived by postulating that the classical trajectory makes the first variation of the action integral vanish. The first variation of a functional is an extension of the definition of derivatives to the world of functionals.
We consider how the action changes when the trajectories undergo an arbitrary variation</p>
<div class="amsmath math notranslate nohighlight" id="equation-b4c79d74-9ede-46fb-8bfc-dbdbf1f5b8a8">
<span class="eqno">(18)<a class="headerlink" href="#equation-b4c79d74-9ede-46fb-8bfc-dbdbf1f5b8a8" title="Permalink to this equation">#</a></span>\[\begin{align}
    \textbf{q}_j(t,\alpha) &amp;= \textbf{q}_j(t,0) + \alpha \textbf{n}_j(t), &amp; \dot{\textbf{q}}_j(t,\alpha) &amp;= \dot{\textbf{q}}_j(t,0) + \alpha \dot{\textbf{n}}_j(t),
\end{align}\]</div>
<p>and denote the action for such trajectories as</p>
<div class="amsmath math notranslate nohighlight" id="equation-cc8944e6-eeaf-42bd-a91a-e3ebc645f2cc">
<span class="eqno">(19)<a class="headerlink" href="#equation-cc8944e6-eeaf-42bd-a91a-e3ebc645f2cc" title="Permalink to this equation">#</a></span>\[\begin{equation}
S(\alpha) = \int_{t_1}^{t_2} \mathcal{L} (\textbf{q}_1(t,\alpha),...,\textbf{q}_N(t,\alpha),  \dot{\textbf{q}}_1(t,\alpha),...,\dot{\textbf{q}}_N(t,\alpha)) \mathrm{d}t.
\end{equation}\]</div>
<p>The first variation of <span class="math notranslate nohighlight">\(S\)</span> is defined as</p>
<div class="math notranslate nohighlight" id="equation-s-deriv">
<span class="eqno">(20)<a class="headerlink" href="#equation-s-deriv" title="Link to this equation">#</a></span>\[
\delta S = \frac{\mathrm{d} S}{\mathrm{d} \alpha} \Bigg|_{\alpha=0} \mathrm{d} \alpha = \int_{t_1}^{t_2} \frac{\mathrm{d \mathcal{L}}}{\mathrm{d} \alpha} \Bigg|_{\alpha=0} \mathrm{d} \alpha \mathrm{d}t, 
\]</div>
<p>and we search for the conditions that satisfy <span class="math notranslate nohighlight">\(\delta S = 0.\)</span></p>
<p>Taking the derivative of the Lagrangian we get</p>
<div class="math notranslate nohighlight">
\[
\frac{\mathrm{d} \mathcal{L}}{\mathrm{d} \alpha} = \sum_{j=1}^N \left[ \frac{\partial \mathcal{L}}{\partial \textbf{q}_j} \cdot \frac{\partial \textbf{q}_j}{\partial \alpha}  + \frac{\partial \mathcal{L}}{\partial \dot{\textbf{q}}_j} \cdot \frac{\partial \dot{\textbf{q}}_j}{\partial \alpha} \right].
\]</div>
<p>The derivative of <span class="math notranslate nohighlight">\(S\)</span> is just the time-integral of the derivative of <span class="math notranslate nohighlight">\(\mathcal{L}\)</span>. If we realize that <span class="math notranslate nohighlight">\(\frac{\partial \dot{\textbf{q}}_j}{\partial \alpha} =  \frac{\partial^2 \textbf{q}_j}{\partial t \partial \alpha}\)</span>, and integrate the second term by parts, we get</p>
<div class="math notranslate nohighlight">
\[
\frac{\mathrm{d} S}{\mathrm{d} \alpha} =  \sum_{j=1}^N \frac{\partial \mathcal{L}}{\partial \dot{\textbf{q}}_j} \cdot \frac{\partial \textbf{q}_j}{\partial \alpha} \Bigg|_{t_1}^{t_2} +  \sum_{j=1}^N \int_{t_1}^{t_2} \left[ \frac{\partial \mathcal{L}}{\partial \textbf{q}_j}  - \frac{\mathrm{d}}{\mathrm{d} t} \frac{\partial \mathcal{L}}{\partial \dot{\textbf{q}}_j} \right] \cdot \frac{\partial \textbf{q}_j}{\partial \alpha} \mathrm{d}t.
\]</div>
<p>The first term vanishes because the path variations at the endpoints have to be zero to fulfill the boundary conditions. Plugging the second term into Eq. <a class="reference internal" href="#equation-s-deriv">(20)</a> gives</p>
<div class="math notranslate nohighlight" id="equation-deltas">
<span class="eqno">(21)<a class="headerlink" href="#equation-deltas" title="Link to this equation">#</a></span>\[
\delta S = \sum_{j=1}^N \int_{t_1}^{t_2} \left[ \frac{\partial \mathcal{L}}{\partial \textbf{q}_j}  - \frac{\mathrm{d}}{\mathrm{d} t} \frac{\partial \mathcal{L}}{\partial \dot{\textbf{q}}_j} \right] \cdot \delta \textbf{q}_j \mathrm{d}t = 0,
\]</div>
<p>where <span class="math notranslate nohighlight">\( \delta \textbf{q}_j = \left( \frac{\partial \textbf{q}_j}{\partial \alpha} \right)_{\alpha=0} \mathrm{d} \alpha\)</span>.
But since the path variations <span class="math notranslate nohighlight">\(\delta \textbf{q}_j\)</span> are independent, Eq. <a class="reference internal" href="#equation-deltas">(21)</a> has to vanish for each <span class="math notranslate nohighlight">\(j\)</span> separately. This is achieved by having the term in square brackets equal to zero which gives the Euler-Lagrange equations <a class="reference internal" href="#equation-el-eq">(10)</a>.</p>
<p>This result tells us that
out of all the possible paths that connect <span class="math notranslate nohighlight">\(\textbf{Q}(t_1), \dot{\textbf{Q}}(t_1)\)</span> and <span class="math notranslate nohighlight">\(\textbf{Q}(t_2), \dot{\textbf{Q}}(t_2)\)</span> the classical path is the one for which the action integral is stationary (also known as Hamilton’s principle).</p>
<p>Is this postulate involving the first variation of the action more fundamental than the three laws of Newton or the Euler-Lagrange equations? In the last project of this course, some of you will work on incorporating quantum effects into your classical MD simulations. You will then encounter an ingenious formulation of quantum mechanics, due to Nobel Laureate <a class="reference external" href="https://en.wikipedia.org/wiki/Richard_Feynman">Richard P. Feynman</a>, which beautifully connects classical and quantum mechanics on the same framework involving the action integral. Its core observation is that while in classical mechanics there is one path that connects the initial and final points, the one that makes the action stationary, in quantum mechanics we have to sum over all possible paths - called a path integral.</p>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footnote1" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>We will not go into the details, but the Hamiltonian is defined as a Legendre transform of the Lagrangian with respect to the velocities.</p>
</aside>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "BarakHirshberg/MolecularSimulations",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="StatMech.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Basic statistical mechanics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#newton-s-equations">Newton’s equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-space">Phase space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lagrangian-mechanics">Lagrangian mechanics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hamiltonian-mechanics">Hamiltonian mechanics</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-action">The action</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr. Barak Hirshberg, School of Chemistry, Tel Aviv University, Tel Aviv 6997801, Israel.
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>